{"ast":null,"code":"import _slicedToArray from \"/Users/nikita/Projects/insa/web-socket-messenger/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/nikita/Projects/insa/web-socket-messenger/frontend2/src/components/MessageList/index.js\";\nimport React, { useEffect, useState } from 'react';\nimport Compose from '../Compose';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport Message from '../Message';\nimport moment from 'moment';\nimport './MessageList.css';\nimport axios from \"axios\";\nvar MY_USER_ID = 'apple';\nexport default function MessageList(props) {\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      chatId = _useState2[0],\n      setChatId = _useState2[1];\n\n  var messagesEnd;\n  useEffect(function () {\n    console.log(\"puzidex\");\n    renderMessages();\n    scrollToBottom();\n  }, [props.messagesProp]);\n\n  var scrollToBottom = function scrollToBottom() {\n    messagesEnd.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n\n  var renderMessages = function renderMessages() {\n    var i = 0;\n    var messageCount = props.messagesProp.length;\n    var tempMessages = [];\n\n    while (i < messageCount) {\n      var previous = props.messagesProp[i - 1];\n      var current = props.messagesProp[i];\n      var next = props.messagesProp[i + 1]; // let isMine = current.author === MY_USER_ID;\n\n      console.log(\"lalalalaalal\");\n      console.log(props.username);\n      console.log(props.messagesProp[i].author);\n      var isMine = props.messagesProp[i].author === props.username;\n      var currentMoment = moment(current.timestamp);\n      var prevBySameAuthor = false;\n      var nextBySameAuthor = false;\n      var startsSequence = true;\n      var endsSequence = true;\n      var showTimestamp = true;\n\n      if (previous) {\n        var previousMoment = moment(previous.timestamp);\n        var previousDuration = moment.duration(currentMoment.diff(previousMoment));\n        prevBySameAuthor = previous.author === current.author;\n\n        if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n          startsSequence = false;\n        }\n\n        if (previousDuration.as('hours') < 1) {\n          showTimestamp = false;\n        }\n      }\n\n      if (next) {\n        var nextMoment = moment(next.timestamp);\n        var nextDuration = moment.duration(nextMoment.diff(currentMoment));\n        nextBySameAuthor = next.author === current.author;\n\n        if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n          endsSequence = false;\n        }\n      }\n\n      tempMessages.push(React.createElement(Message, {\n        key: i,\n        isMine: isMine,\n        startsSequence: startsSequence,\n        endsSequence: endsSequence,\n        showTimestamp: showTimestamp,\n        data: current,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      })); // Proceed to the next message.\n\n      i += 1;\n    }\n\n    return tempMessages;\n  };\n\n  return React.createElement(\"div\", {\n    className: \"message-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(Toolbar, {\n    title: \"Conversation Title\",\n    rightItems: [React.createElement(ToolbarButton, {\n      key: \"info\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-information-circle-outline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"video\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-videocam\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"phone\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-call\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    })],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"message-list-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, renderMessages(), React.createElement(\"div\", {\n    style: {\n      float: \"left\",\n      clear: \"both\"\n    },\n    ref: function ref(el) {\n      messagesEnd = el;\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  })), React.createElement(Compose, {\n    sendMessage: props.sendMessage,\n    rightItems: [React.createElement(ToolbarButton, {\n      key: \"photo\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-camera\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"image\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"audio\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-mic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"money\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"games\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-logo-game-client.controller-b\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }), React.createElement(ToolbarButton, {\n      key: \"emoji\",\n      onClick: function onClick() {\n        return console.log(\"checkInfo\");\n      },\n      icon: \"ion-ios-happy\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    })],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }));\n}","map":{"version":3,"sources":["/Users/nikita/Projects/insa/web-socket-messenger/frontend2/src/components/MessageList/index.js"],"names":["React","useEffect","useState","Compose","Toolbar","ToolbarButton","Message","moment","axios","MY_USER_ID","MessageList","props","chatId","setChatId","messagesEnd","console","log","renderMessages","scrollToBottom","messagesProp","scrollIntoView","behavior","i","messageCount","length","tempMessages","previous","current","next","username","author","isMine","currentMoment","timestamp","prevBySameAuthor","nextBySameAuthor","startsSequence","endsSequence","showTimestamp","previousMoment","previousDuration","duration","diff","as","nextMoment","nextDuration","push","float","clear","el","sendMessage"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Compose from '../Compose';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport Message from '../Message';\nimport moment from 'moment';\n\nimport './MessageList.css';\nimport axios from \"axios\";\n\nconst MY_USER_ID = 'apple';\n\nexport default function MessageList(props) {\n    const [chatId, setChatId] = useState(0);\n\n    let messagesEnd;\n\n    useEffect(() => {\n        console.log(\"puzidex\")\n        renderMessages();\n        scrollToBottom();\n    },[props.messagesProp]);\n\n    const scrollToBottom = () => {\n        messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n    }\n\n  const renderMessages = () => {\n    let i = 0;\n    let messageCount = props.messagesProp.length;\n    let tempMessages = [];\n\n    while (i < messageCount) {\n      let previous = props.messagesProp[i - 1];\n      let current = props.messagesProp[i];\n      let next = props.messagesProp[i + 1];\n      // let isMine = current.author === MY_USER_ID;\n        console.log(\"lalalalaalal\")\n        console.log(props.username)\n        console.log(props.messagesProp[i].author)\n      let isMine = props.messagesProp[i].author===props.username;\n      let currentMoment = moment(current.timestamp);\n      let prevBySameAuthor = false;\n      let nextBySameAuthor = false;\n      let startsSequence = true;\n      let endsSequence = true;\n      let showTimestamp = true;\n\n      if (previous) {\n        let previousMoment = moment(previous.timestamp);\n        let previousDuration = moment.duration(currentMoment.diff(previousMoment));\n        prevBySameAuthor = previous.author === current.author;\n        \n        if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n          startsSequence = false;\n        }\n\n        if (previousDuration.as('hours') < 1) {\n          showTimestamp = false;\n        }\n      }\n\n      if (next) {\n        let nextMoment = moment(next.timestamp);\n        let nextDuration = moment.duration(nextMoment.diff(currentMoment));\n        nextBySameAuthor = next.author === current.author;\n\n        if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n          endsSequence = false;\n        }\n      }\n\n      tempMessages.push(\n        <Message\n          key={i}\n          isMine={isMine}\n          startsSequence={startsSequence}\n          endsSequence={endsSequence}\n          showTimestamp={showTimestamp}\n          data={current}\n        />\n      );\n\n      // Proceed to the next message.\n      i += 1;\n    }\n\n    return tempMessages;\n  }\n\n    return(\n      <div className=\"message-list\">\n        <Toolbar\n          title=\"Conversation Title\"\n          rightItems={[\n            <ToolbarButton key=\"info\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-information-circle-outline\" />,\n            <ToolbarButton key=\"video\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-videocam\" />,\n            <ToolbarButton key=\"phone\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-call\" />\n          ]}\n        />\n\n        <div className=\"message-list-container\">\n            {renderMessages()}\n            <div style={{ float:\"left\", clear: \"both\" }}\n                 ref={(el) => { messagesEnd = el; }}>\n            </div>\n        </div>\n\n\n        <Compose sendMessage={props.sendMessage} rightItems={[\n          <ToolbarButton key=\"photo\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-camera\" />,\n          <ToolbarButton key=\"image\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-image\" />,\n          <ToolbarButton key=\"audio\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-mic\" />,\n          <ToolbarButton key=\"money\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-card\" />,\n          <ToolbarButton key=\"games\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-logo-game-client.controller-b\" />,\n          <ToolbarButton key=\"emoji\" onClick={() => console.log(\"checkInfo\")} icon=\"ion-ios-happy\" />\n        ]}/>\n      </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}