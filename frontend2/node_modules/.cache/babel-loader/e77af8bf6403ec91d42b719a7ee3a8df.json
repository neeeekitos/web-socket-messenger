{"ast":null,"code":"import _regeneratorRuntime from \"/Users/nikita/Projects/insa/web-socket-messenger/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/nikita/Projects/insa/web-socket-messenger/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/nikita/Projects/insa/web-socket-messenger/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/nikita/Projects/insa/web-socket-messenger/frontend/src/components/ConversationList/index.js\";\nimport React, { useState, useEffect } from 'react';\nimport ConversationSearch from '../ConversationSearch';\nimport ConversationListItem from '../ConversationListItem';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport axios from 'axios';\nimport './ConversationList.css';\nimport AddChat from \"./AddChat\";\nexport default function ConversationList(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      conversations = _useState2[0],\n      setConversations = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      addChatOpened = _useState4[0],\n      setNewChatOpen = _useState4[1];\n\n  useEffect(function () {\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return setChats();\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }))();\n  }, [props.chats]);\n\n  var setChats =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var responseArray, conversationsNumber, responseImagers, newConversations;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(props.chats);\n              responseArray = props.chats;\n              conversationsNumber = responseArray.length;\n              console.log(\"fetching images for \".concat(conversationsNumber, \" conversations.\"));\n              _context2.next = 6;\n              return axios.get(\"https://randomuser.me/api/?results=\".concat(conversationsNumber));\n\n            case 6:\n              responseImagers = _context2.sent;\n              newConversations = responseArray.map(function (result, index) {\n                console.log(props.username);\n                console.log(result.participantsUsernames.toString().replace(props.username, ''));\n                return {\n                  photo: responseImagers.data.results[index].picture.large,\n                  name: result.groupName ? result.groupName : result.participantsUsernames.toString().replace(\"Nikita\", ''),\n                  text: 'Hello world! This is a long message that needs to be truncated.',\n                  chatId: result.chatId\n                };\n              }); // setConversations([...conversations, ...newConversations])\n\n              setConversations(newConversations);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function setChats() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var createChat =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(isGroup, name) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log('creating chat...');\n              console.log(isGroup);\n              console.log(name);\n\n              if (!isGroup) {\n                _context3.next = 9;\n                break;\n              }\n\n              _context3.next = 6;\n              return axios.post('http://localhost:8081/actions/createGroup', name, {\n                headers: {\n                  'Content-Type': 'text/plain'\n                }\n              });\n\n            case 6:\n              response = _context3.sent;\n              _context3.next = 12;\n              break;\n\n            case 9:\n              _context3.next = 11;\n              return axios.post('http://localhost:8081/actions/createO2o', name, {\n                headers: {\n                  'Content-Type': 'text/plain'\n                }\n              });\n\n            case 11:\n              response = _context3.sent;\n\n            case 12:\n              console.log(response.data, response.status);\n              alert(\"Server response : \".concat(response.data));\n              console.log(response);\n              _context3.next = 17;\n              return axios.get(\"http://localhost:8081/actions/allUserChats\");\n\n            case 17:\n              // close add chat section\n              setNewChatOpen(false);\n\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function createChat(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(\"div\", {\n    className: \"conversation-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(Toolbar, {\n    title: \"Messenger\",\n    leftItems: [React.createElement(ToolbarButton, {\n      key: \"cog\",\n      onClick: function onClick() {\n        return console.log(\"properties open\");\n      },\n      icon: \"ion-ios-cog\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    })],\n    rightItems: [React.createElement(ToolbarButton, {\n      key: \"add\",\n      onClick: function onClick() {\n        return setNewChatOpen(true);\n      },\n      icon: \"ion-ios-add-circle-outline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    })],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }), React.createElement(AddChat, {\n    allUsers: props.allUsers,\n    disabled: !addChatOpened,\n    createChat: createChat,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), React.createElement(ConversationSearch, {\n    onclick: function onclick() {\n      return console.log(\"search\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }), conversations.map(function (conversation) {\n    return React.createElement(ConversationListItem, {\n      getMessagesByChatId: props.getMessagesByChatId,\n      key: conversation.name,\n      data: conversation,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    });\n  }));\n}","map":{"version":3,"sources":["/Users/nikita/Projects/insa/web-socket-messenger/frontend/src/components/ConversationList/index.js"],"names":["React","useState","useEffect","ConversationSearch","ConversationListItem","Toolbar","ToolbarButton","axios","AddChat","ConversationList","props","conversations","setConversations","addChatOpened","setNewChatOpen","setChats","chats","console","log","responseArray","conversationsNumber","length","get","responseImagers","newConversations","map","result","index","username","participantsUsernames","toString","replace","photo","data","results","picture","large","name","groupName","text","chatId","createChat","isGroup","post","headers","response","status","alert","allUsers","conversation","getMessagesByChatId"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport ConversationSearch from '../ConversationSearch';\nimport ConversationListItem from '../ConversationListItem';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport axios from 'axios';\n\nimport './ConversationList.css';\nimport AddChat from \"./AddChat\";\n\nexport default function ConversationList(props) {\n    const [conversations, setConversations] = useState([]);\n    const [addChatOpened, setNewChatOpen] = useState(false);\n\n    useEffect(() => {\n        (async () => {\n            await setChats();\n        })();\n    },[props.chats]);\n\n    const setChats = async () => {\n\n        console.log(props.chats)\n        const responseArray = props.chats;\n        const conversationsNumber = responseArray.length;\n        console.log(`fetching images for ${conversationsNumber} conversations.`);\n\n        const responseImagers = await axios.get(`https://randomuser.me/api/?results=${conversationsNumber}`);\n\n        let newConversations = responseArray.map((result, index) => {\n            console.log(props.username)\nconsole.log(result.participantsUsernames.toString().replace(props.username,''));\n            return {\n              photo: responseImagers.data.results[index].picture.large,\n              name:  (result.groupName) ? result.groupName : result.participantsUsernames.toString().replace(\"Nikita\",''),\n              text: 'Hello world! This is a long message that needs to be truncated.',\n              chatId: result.chatId\n          };\n        });\n        // setConversations([...conversations, ...newConversations])\n        setConversations(newConversations);\n\n    }\n\n  const createChat = async (isGroup, name) => {\n\n      console.log('creating chat...')\n      console.log(isGroup)\n      console.log(name)\n      let response;\n      if (isGroup)\n        response = await axios.post('http://localhost:8081/actions/createGroup', name,\n            {\n                headers: {\n                    'Content-Type': 'text/plain',\n                }\n            });\n      else\n        response = await axios.post('http://localhost:8081/actions/createO2o', name,\n            {\n                headers: {\n                    'Content-Type': 'text/plain',\n                }\n            });\n\n      console.log(response.data, response.status);\n      alert(`Server response : ${response.data}`);\n      console.log(response);\n      await axios.get(\"http://localhost:8081/actions/allUserChats\");\n\n      // close add chat section\n      setNewChatOpen(false);\n  }\n\n    return (\n      <div className=\"conversation-list\" >\n        <Toolbar\n          title=\"Messenger\"\n          leftItems={[\n            <ToolbarButton key=\"cog\" onClick={() => console.log(\"properties open\")} icon=\"ion-ios-cog\" />\n          ]}\n          rightItems={[\n            <ToolbarButton key=\"add\"  onClick={() => setNewChatOpen(true)} icon=\"ion-ios-add-circle-outline\" />\n          ]}\n        />\n          <AddChat allUsers={props.allUsers} disabled={!addChatOpened}  createChat={createChat}/>\n        <ConversationSearch onclick={() => console.log(\"search\")}  />\n        {\n          conversations.map(conversation =>\n            <ConversationListItem\n                getMessagesByChatId={props.getMessagesByChatId}\n                key={conversation.name}\n                data={conversation}\n            />\n          )\n        }\n      </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}